{"version":3,"file":"DIMLoadoutViewerPage-Dp_5jU7G.js","sources":["../../../../src/components/common/NamingModal.tsx","../../../../src/pages/DIMLoadoutViewerPage.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport MouseLeftIcon from '../../assets/mouse-left-plain.png';\r\nimport MouseRightIcon from '../../assets/mouse-right-plain.png';\r\nimport './NamingModal.css';\r\n\r\nexport interface NamingModalProps {\r\n    isOpen: boolean;\r\n    title?: string;\r\n    message: string;\r\n    defaultValue?: string;\r\n    onConfirm: (name: string) => void;\r\n    onCancel: () => void;\r\n}\r\n\r\nexport const NamingModal: React.FC<NamingModalProps> = ({\r\n    isOpen,\r\n    title = 'NAME YOUR BUILD',\r\n    message,\r\n    defaultValue = '',\r\n    onConfirm,\r\n    onCancel\r\n}) => {\r\n    const [name, setName] = useState(defaultValue);\r\n    const inputRef = useRef<HTMLInputElement>(null);\r\n\r\n    useEffect(() => {\r\n        if (isOpen) {\r\n            setName(defaultValue);\r\n            // Focus input on open\r\n            setTimeout(() => {\r\n                inputRef.current?.focus();\r\n                inputRef.current?.select();\r\n            }, 100);\r\n        }\r\n    }, [isOpen, defaultValue]);\r\n\r\n    // Handle mouse actions to match ConfirmationModal\r\n    const handleModalClick = () => {\r\n        onCancel();\r\n    };\r\n\r\n    const handleModalContextMenu = (e: React.MouseEvent) => {\r\n        e.preventDefault();\r\n        if (name.trim()) {\r\n            onConfirm(name.trim());\r\n        }\r\n    };\r\n\r\n    // Global listeners\r\n    useEffect(() => {\r\n        if (!isOpen) return;\r\n\r\n        const handleGlobalContextMenu = (e: MouseEvent) => {\r\n            e.preventDefault();\r\n            if (name.trim()) {\r\n                onConfirm(name.trim());\r\n            }\r\n        };\r\n\r\n        const handleKeyDown = (e: KeyboardEvent) => {\r\n            if (e.key === 'Enter' && name.trim()) {\r\n                onConfirm(name.trim());\r\n            } else if (e.key === 'Escape') {\r\n                onCancel();\r\n            }\r\n        };\r\n\r\n        document.addEventListener('contextmenu', handleGlobalContextMenu);\r\n        document.addEventListener('keydown', handleKeyDown);\r\n        return () => {\r\n            document.removeEventListener('contextmenu', handleGlobalContextMenu);\r\n            document.removeEventListener('keydown', handleKeyDown);\r\n        };\r\n    }, [isOpen, name, onConfirm, onCancel]);\r\n\r\n    if (!isOpen) return null;\r\n\r\n    return (\r\n        <div\r\n            className=\"d2-confirmation-modal-backdrop\"\r\n            onClick={handleModalClick}\r\n            onContextMenu={handleModalContextMenu}\r\n        >\r\n            <div className=\"d2-confirmation-strip\">\r\n                <div className=\"d2-modal-container\">\r\n                    <div className=\"d2-modal-main\" onClick={(e) => e.stopPropagation()}>\r\n                        <div className=\"d2-modal-header d2-modal-header--info\">\r\n                            <div className=\"d2-info-icon-container\">\r\n                                <div className=\"info-circle info-circle--info\">\r\n                                    A\r\n                                </div>\r\n                            </div>\r\n                            <h1 className=\"d2-confirmation-title\">{title}</h1>\r\n                        </div>\r\n                        <div className=\"d2-modal-body d2-modal-body--naming\">\r\n                            <div className=\"naming-container\">\r\n                                <p className=\"d2-confirmation-message\">{message}</p>\r\n                                <input\r\n                                    ref={inputRef}\r\n                                    id=\"build-naming-input\"\r\n                                    name=\"build-naming-input\"\r\n                                    type=\"text\"\r\n                                    className=\"d2-naming-input\"\r\n                                    value={name}\r\n                                    onChange={(e) => setName(e.target.value)}\r\n                                    placeholder=\"Enter build name...\"\r\n                                    maxLength={40}\r\n                                    autoFocus\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"d2-modal-footer\">\r\n                            <div className=\"d2-confirmation-controls\">\r\n                                <div className=\"control-group\"\r\n                                    onClick={(e) => { e.stopPropagation(); if (name.trim()) onConfirm(name.trim()); }}\r\n                                    onContextMenu={(e) => { e.stopPropagation(); e.preventDefault(); if (name.trim()) onConfirm(name.trim()); }}\r\n                                >\r\n                                    <img src={MouseRightIcon} className=\"mouse-icon-img\" alt=\"R\" />\r\n                                    <span className=\"control-label confirm\">SAVE</span>\r\n                                </div>\r\n                                <div className=\"control-group\"\r\n                                    onClick={(e) => { e.stopPropagation(); onCancel(); }}\r\n                                    onContextMenu={(e) => { e.stopPropagation(); e.preventDefault(); if (name.trim()) onConfirm(name.trim()); }}\r\n                                >\r\n                                    <img src={MouseLeftIcon} className=\"mouse-icon-img\" alt=\"L\" />\r\n                                    <span className=\"control-label cancel\">CANCEL</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","import { useState, useEffect, useRef } from 'react';\r\nimport { useNavigate, useSearchParams } from 'react-router-dom';\r\nimport { manifestService } from '../services/bungie/manifest.service';\r\nimport { loadoutLinkService } from '../services/bungie/loadout-link.service';\r\nimport { buildService } from '../services/build.service';\r\nimport type { LoadoutShareData } from '../services/bungie/loadout-link.service';\r\nimport { BUCKET_HASHES } from '../config/bungie.config';\r\nimport { getBungieUrl } from '../utils/url-helper';\r\nimport { LoadingScreen } from '../components/common/Loader';\r\nimport { SubclassNode } from '../components/builder/SubclassNode';\r\nimport { RichTooltip } from '../components/builder/RichTooltip';\r\nimport { distributeLoadoutMods, categorizeMods } from '../utils/loadout-mods.utils';\r\nimport { errorLog } from '../utils/logger';\r\nimport { RichItemIcon } from '../components/common/RichItemIcon';\r\nimport { NamingModal } from '../components/common/NamingModal';\r\nimport './DIMLoadoutViewerPage.css';\r\n\r\nconst ELEMENT_NAMES: Record<number, string> = {\r\n    1: 'kinetic',\r\n    2: 'arc',\r\n    3: 'solar',\r\n    4: 'void',\r\n    6: 'stasis',\r\n    7: 'strand',\r\n};\r\n\r\nconst CLASS_NAMES: Record<number, string> = {\r\n    0: 'Titan',\r\n    1: 'Hunter',\r\n    2: 'Warlock',\r\n};\r\n\r\nconst PRISMATIC_HASHES = [2946726027, 2603483315, 3170703816, 3893112950];\r\n\r\nexport function DIMLoadoutViewerPage() {\r\n    const navigate = useNavigate();\r\n    const [searchParams] = useSearchParams();\r\n    const [loadout, setLoadout] = useState<LoadoutShareData | null>(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState<string | null>(null);\r\n    const [isLoreOpen, setIsLoreOpen] = useState(false);\r\n    const [isUiVisible, setIsUiVisible] = useState(true);\r\n    const [hoveredItemHash, setHoveredItemHash] = useState<number | null>(null);\r\n    const [isNamingModalOpen, setIsNamingModalOpen] = useState(false);\r\n\r\n    // Notification banner state\r\n    const [notification, setNotification] = useState<string | null>(null);\r\n    const [notificationTimeout, setNotificationTimeout] = useState<NodeJS.Timeout | null>(null);\r\n\r\n    // Parallax background ref and mouse tracking\r\n    const bgRef = useRef<HTMLDivElement>(null);\r\n    const [mousePos, setMousePos] = useState({ x: 0.5, y: 0.5 });\r\n\r\n    // Show notification banner\r\n    const showNotification = (message: string) => {\r\n        if (notificationTimeout) clearTimeout(notificationTimeout);\r\n        setNotification(message);\r\n        const timeout = setTimeout(() => setNotification(null), 2500);\r\n        setNotificationTimeout(timeout);\r\n    };\r\n\r\n    useEffect(() => {\r\n        const loadDIMLoadout = async () => {\r\n            try {\r\n                const url = searchParams.get('url');\r\n                if (!url) {\r\n                    setError('No DIM link provided. Please paste a DIM link.');\r\n                    setLoading(false);\r\n                    return;\r\n                }\r\n\r\n                const loadoutData = await loadoutLinkService.parseLoadoutLink(url);\r\n                setLoadout(loadoutData);\r\n                setLoading(false);\r\n            } catch (err) {\r\n                errorLog('DIMLoadoutViewer', 'Error:', err);\r\n                setError(err instanceof Error ? err.message : 'Failed to load DIM loadout');\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        loadDIMLoadout();\r\n    }, [searchParams]);\r\n\r\n    // Keyboard shortcuts\r\n    useEffect(() => {\r\n        const handler = async (e: KeyboardEvent) => {\r\n            const activeEl = document.activeElement;\r\n            const isTyping = activeEl && (\r\n                activeEl.tagName === 'INPUT' ||\r\n                activeEl.tagName === 'TEXTAREA' ||\r\n                (activeEl as HTMLElement).isContentEditable\r\n            );\r\n\r\n            if (isTyping) return;\r\n\r\n            // A - Toggle lore/details panel\r\n            if (e.key === 'a' || e.key === 'A') {\r\n                setIsLoreOpen(p => !p);\r\n            }\r\n            // CTRL - Toggle UI visibility\r\n            if (e.key === 'Control') {\r\n                setIsUiVisible(p => !p);\r\n            }\r\n            // ESC - Back to agent\r\n            if (e.key === 'Escape') {\r\n                navigate('/agent-wake');\r\n            }\r\n            // D - Save build\r\n            if (e.key === 'd' || e.key === 'D') {\r\n                await handleSaveBuild();\r\n            }\r\n        };\r\n        window.addEventListener('keydown', handler);\r\n        return () => window.removeEventListener('keydown', handler);\r\n    }, [navigate, loadout]);\r\n\r\n    // Normalized values for parallax\r\n    const handleMouseMove = (e: React.MouseEvent) => {\r\n        const { clientX, clientY } = e;\r\n        const { innerWidth, innerHeight } = window;\r\n        const x = (clientX / innerWidth) - 0.5;\r\n        const y = (clientY / innerHeight) - 0.5;\r\n        setMousePos({ x, y });\r\n    };\r\n\r\n    const handleSaveBuild = async () => {\r\n        if (!loadout) return;\r\n        setIsNamingModalOpen(true);\r\n    };\r\n\r\n    const confirmSaveBuild = async (buildName: string) => {\r\n        if (!loadout) return;\r\n        setIsNamingModalOpen(false);\r\n\r\n        try {\r\n\r\n            // Find subclass for element detection\r\n            const subclassItem = loadout.equipped.find(item => {\r\n                const def = manifestService.getItem(item.hash);\r\n                return def?.inventory?.bucketTypeHash === BUCKET_HASHES.SUBCLASS;\r\n            });\r\n\r\n            const subclassDef = subclassItem ? manifestService.getItem(subclassItem.hash) : null;\r\n            const damageType = subclassDef?.talentGrid?.hudDamageType || 3;\r\n\r\n            // Map damage type to element\r\n            const damageTypeMap: Record<number, string> = {\r\n                1: 'kinetic',\r\n                2: 'arc',\r\n                3: 'solar',\r\n                4: 'void',\r\n                6: 'stasis',\r\n                7: 'strand'\r\n            };\r\n            let element = damageTypeMap[damageType] || 'kinetic';\r\n\r\n            if (\r\n                PRISMATIC_HASHES.includes(subclassItem?.hash || 0) ||\r\n                (subclassDef as any)?.plug?.plugCategoryIdentifier?.toLowerCase()?.includes('prismatic') ||\r\n                subclassDef?.displayProperties?.name?.toLowerCase().includes('prismatic') ||\r\n                (subclassDef as any)?.itemTypeDisplayName?.toLowerCase()?.includes('prismatic')\r\n            ) {\r\n                element = 'prismatic';\r\n            }\r\n\r\n            // Extract subclass socket overrides\r\n            const getSocketHash = (socketIndex: number) => {\r\n                if (!subclassItem?.socketOverrides) return undefined;\r\n                return subclassItem.socketOverrides[socketIndex];\r\n            };\r\n\r\n            // Get aspect and fragment hashes\r\n            const aspectHashes: number[] = [];\r\n            const fragmentHashes: number[] = [];\r\n\r\n            if (subclassItem?.socketOverrides) {\r\n                Object.entries(subclassItem.socketOverrides).forEach(([idxStr, hash]) => {\r\n                    const idx = parseInt(idxStr);\r\n                    const def = manifestService.getItem(hash as number);\r\n                    if (!def) return;\r\n\r\n                    // Skip main abilities\r\n                    if (idx >= 0 && idx <= 4) return;\r\n\r\n                    const category = (def.plug?.plugCategoryIdentifier || \"\").toLowerCase();\r\n                    const typeName = (def.itemTypeDisplayName || \"\").toLowerCase();\r\n                    const name = (def.displayProperties?.name || \"\").toLowerCase();\r\n\r\n                    if (category.includes('aspect') || typeName.includes('aspect')) {\r\n                        aspectHashes.push(hash as number);\r\n                    } else if (category.includes('fragment') || category.includes('facet') ||\r\n                        typeName.includes('fragment') || typeName.includes('facet') ||\r\n                        name.includes('facet of')) {\r\n                        fragmentHashes.push(hash as number);\r\n                    }\r\n                });\r\n            }\r\n\r\n            // Find exotic weapon and armor, and collect all gameplay mods\r\n            let exoticWeapon = { hash: 0, name: 'None', slot: 0 };\r\n            let exoticArmor = { hash: 0, name: 'None', slot: 3 };\r\n            const armorMods: number[] = [];\r\n\r\n            // Helper to check if a plug is a gameplay mod (vs shader/ornament)\r\n            const isGameplayMod = (hash: number) => {\r\n                const pDef = manifestService.getItem(hash);\r\n                if (!pDef) return false;\r\n                const plugCat = (pDef.plug?.plugCategoryIdentifier || '').toLowerCase();\r\n                return plugCat.includes('enhancements') ||\r\n                    plugCat.includes('armor_stats') ||\r\n                    plugCat.includes('armor_mods');\r\n            };\r\n\r\n            // Gather all gameplay mods from parameters\r\n            if (loadout.parameters?.mods) {\r\n                loadout.parameters.mods.forEach(h => {\r\n                    if (isGameplayMod(h)) armorMods.push(h);\r\n                });\r\n            } else if (loadout.parameters?.modsByBucket) {\r\n                Object.values(loadout.parameters.modsByBucket).forEach((bucketMods: any) => {\r\n                    if (Array.isArray(bucketMods)) {\r\n                        bucketMods.forEach(h => {\r\n                            if (isGameplayMod(h)) armorMods.push(h);\r\n                        });\r\n                    }\r\n                });\r\n            }\r\n\r\n            loadout.equipped.forEach(item => {\r\n                const def = manifestService.getItem(item.hash);\r\n                if (!def) return;\r\n\r\n                // Check if exotic (tier type 6)\r\n                if (def.inventory?.tierType === 6 || def.tierType === 6) {\r\n                    if (def.itemType === 3) { // Weapon\r\n                        exoticWeapon = {\r\n                            hash: item.hash,\r\n                            name: def.displayProperties?.name || 'Unknown',\r\n                            slot: (def.inventory?.bucketTypeHash === BUCKET_HASHES.KINETIC_WEAPONS ? 0 :\r\n                                def.inventory?.bucketTypeHash === BUCKET_HASHES.ENERGY_WEAPONS ? 1 : 2) as any\r\n                        };\r\n                    } else if (def.itemType === 2) { // Armor\r\n                        exoticArmor = {\r\n                            hash: item.hash,\r\n                            name: def.displayProperties?.name || 'Unknown',\r\n                            slot: 3\r\n                        };\r\n                    }\r\n                }\r\n            });\r\n\r\n            // Build the template matching BuildTemplate interface\r\n            const template = {\r\n                id: `dim-${Date.now()}`,\r\n                name: buildName,\r\n                element: element as any,\r\n                guardianClass: loadout.classType,\r\n                exoticWeapon: exoticWeapon as any,\r\n                exoticArmor: exoticArmor as any,\r\n                subclassConfig: {\r\n                    subclassHash: subclassItem?.hash,\r\n                    superHash: getSocketHash(0) || 0,\r\n                    aspects: aspectHashes,\r\n                    fragments: fragmentHashes,\r\n                    grenadeHash: getSocketHash(4),\r\n                    meleeHash: getSocketHash(3),\r\n                    classAbilityHash: getSocketHash(2),\r\n                },\r\n                playstyle: 'DIM Import',\r\n                difficulty: 'intermediate' as const,\r\n                // Store the original loadout for full fidelity when viewing\r\n                originalLoadout: loadout,\r\n                armorMods, // Populate flat mods array for compact card view\r\n                source: 'dim' as const\r\n            };\r\n\r\n            await buildService.saveBuild(template, buildName);\r\n            showNotification(`Build \"${buildName}\" saved to Loadout Vault`);\r\n        } catch (error) {\r\n            errorLog('DIMLoadoutViewerPage', 'Failed to save build:', error);\r\n            showNotification('Failed to save build');\r\n        }\r\n    };\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"dim-loadout-viewer\">\r\n                <LoadingScreen />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (error) {\r\n        return (\r\n            <div className=\"dim-loadout-viewer\">\r\n                <div className=\"dim-error\">\r\n                    <h2>Error Loading Loadout</h2>\r\n                    <p style={{ whiteSpace: 'pre-wrap' }}>{error}</p>\r\n                    <button onClick={() => navigate('/agent-wake')}>Back to Agent</button>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (!loadout) {\r\n        return (\r\n            <div className=\"dim-loadout-viewer\">\r\n                <div className=\"dim-error\">\r\n                    <h2>No Loadout Found</h2>\r\n                    <button onClick={() => navigate('/agent-wake')}>Back to Agent</button>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // Find subclass\r\n    const subclassItem = loadout.equipped.find(item => {\r\n        const def = manifestService.getItem(item.hash);\r\n        return def?.inventory?.bucketTypeHash === BUCKET_HASHES.SUBCLASS;\r\n    });\r\n\r\n    const subclassDef = subclassItem ? manifestService.getItem(subclassItem.hash) : null;\r\n    const damageType = subclassDef?.talentGrid?.hudDamageType || 3;\r\n    let elementName = ELEMENT_NAMES[damageType] || 'solar';\r\n\r\n    // Check for Prismatic subclass\r\n    if (\r\n        PRISMATIC_HASHES.includes(subclassItem?.hash || 0) ||\r\n        (subclassDef as any)?.plug?.plugCategoryIdentifier?.includes('prismatic') ||\r\n        subclassDef?.displayProperties?.name?.toLowerCase().includes('prismatic')\r\n    ) {\r\n        elementName = 'prismatic';\r\n    }\r\n\r\n    const className = CLASS_NAMES[loadout.classType] || 'Titan';\r\n\r\n    // Extract abilities from socket overrides\r\n    const getSocketItem = (socketIndex: number) => {\r\n        if (!subclassItem?.socketOverrides) return null;\r\n        const hash = subclassItem.socketOverrides[socketIndex];\r\n        return hash ? manifestService.getItem(hash) : null;\r\n    };\r\n\r\n    // Debug: Log all socket overrides to see what we have\r\n\r\n    // Debug: Check what's in each socket\r\n\r\n\r\n    // Subclass configuration\r\n    const superDef = getSocketItem(0);\r\n    const jumpDef = getSocketItem(1);\r\n    const classAbilityDef = getSocketItem(2);\r\n    const meleeDef = getSocketItem(3);\r\n    const grenadeDef = getSocketItem(4);\r\n\r\n    // Unified Socket Extraction logic - EXHAUSTIVE VERSION\r\n    const allAspects: any[] = [];\r\n    const allFragments: any[] = [];\r\n    let discoveredTranscendence: any = null;\r\n\r\n    if (subclassItem?.socketOverrides) {\r\n        Object.entries(subclassItem.socketOverrides).forEach(([idxStr, hash]) => {\r\n            const idx = parseInt(idxStr);\r\n            const def = manifestService.getItem(hash as number);\r\n            if (!def) return;\r\n\r\n            // Skip common ability slots to avoid duplicates\r\n            if (idx >= 0 && idx <= 4) return;\r\n\r\n            const category = (def.plug?.plugCategoryIdentifier || \"\").toLowerCase();\r\n            const typeName = (def.itemTypeDisplayName || \"\").toLowerCase();\r\n            const name = (def.displayProperties?.name || \"\").toLowerCase();\r\n\r\n            // 1. Check for Transcendence (Prismatic specialized node)\r\n            if (category.includes('transcendence') || name.includes('transcendence')) {\r\n                discoveredTranscendence = {\r\n                    icon: getBungieUrl(def.displayProperties?.icon || ''),\r\n                    hash: def.hash\r\n                };\r\n                return;\r\n            }\r\n\r\n            // 2. Check for Aspects\r\n            if (category.includes('aspect') || typeName.includes('aspect')) {\r\n                allAspects.push({\r\n                    icon: getBungieUrl(def.displayProperties?.icon || ''),\r\n                    hash: def.hash\r\n                });\r\n                return;\r\n            }\r\n\r\n            // 3. Check for Fragments/Facets\r\n            if (category.includes('fragment') || category.includes('facet') ||\r\n                typeName.includes('fragment') || typeName.includes('facet') ||\r\n                name.includes('facet of')) {\r\n                allFragments.push({\r\n                    icon: getBungieUrl(def.displayProperties?.icon || ''),\r\n                    hash: def.hash\r\n                });\r\n            }\r\n        });\r\n    }\r\n\r\n    // Build icons object (Standardized mapping)\r\n    const buildIcons = {\r\n        super: classAbilityDef ? getBungieUrl(classAbilityDef.displayProperties?.icon || '') : undefined,\r\n        superHash: classAbilityDef?.hash,\r\n        jump: jumpDef ? getBungieUrl(jumpDef.displayProperties?.icon || '') : undefined,\r\n        jumpHash: jumpDef?.hash,\r\n        classAbility: superDef ? getBungieUrl(superDef.displayProperties?.icon || '') : undefined,\r\n        classAbilityHash: superDef?.hash,\r\n        melee: meleeDef ? getBungieUrl(meleeDef.displayProperties?.icon || '') : undefined,\r\n        meleeHash: meleeDef?.hash,\r\n        grenade: grenadeDef ? getBungieUrl(grenadeDef.displayProperties?.icon || '') : undefined,\r\n        grenadeHash: grenadeDef?.hash,\r\n        transcendence: discoveredTranscendence?.icon,\r\n        transcendenceHash: discoveredTranscendence?.hash,\r\n        aspects: allAspects,\r\n        fragments: allFragments\r\n    };\r\n\r\n    // Armor pieces\r\n    const helmet = loadout.equipped.find(i => {\r\n        const def = manifestService.getItem(i.hash);\r\n        return def?.inventory?.bucketTypeHash === BUCKET_HASHES.HELMET;\r\n    });\r\n    const gauntlets = loadout.equipped.find(i => {\r\n        const def = manifestService.getItem(i.hash);\r\n        return def?.inventory?.bucketTypeHash === BUCKET_HASHES.GAUNTLETS;\r\n    });\r\n    const chest = loadout.equipped.find(i => {\r\n        const def = manifestService.getItem(i.hash);\r\n        return def?.inventory?.bucketTypeHash === BUCKET_HASHES.CHEST_ARMOR;\r\n    });\r\n    const legs = loadout.equipped.find(i => {\r\n        const def = manifestService.getItem(i.hash);\r\n        return def?.inventory?.bucketTypeHash === BUCKET_HASHES.LEG_ARMOR;\r\n    });\r\n    const classItem = loadout.equipped.find(i => {\r\n        const def = manifestService.getItem(i.hash);\r\n        return def?.inventory?.bucketTypeHash === BUCKET_HASHES.CLASS_ARMOR;\r\n    });\r\n\r\n    // Weapons\r\n    const kinetic = loadout.equipped.find(i => {\r\n        const def = manifestService.getItem(i.hash);\r\n        return def?.inventory?.bucketTypeHash === BUCKET_HASHES.KINETIC_WEAPONS;\r\n    });\r\n    const energy = loadout.equipped.find(i => {\r\n        const def = manifestService.getItem(i.hash);\r\n        return def?.inventory?.bucketTypeHash === BUCKET_HASHES.ENERGY_WEAPONS;\r\n    });\r\n    const power = loadout.equipped.find(i => {\r\n        const def = manifestService.getItem(i.hash);\r\n        return def?.inventory?.bucketTypeHash === BUCKET_HASHES.POWER_WEAPONS;\r\n    });\r\n\r\n    // Get armor and weapon icons\r\n    const helmetDef = helmet ? manifestService.getItem(helmet.hash) : null;\r\n    const gauntletsDef = gauntlets ? manifestService.getItem(gauntlets.hash) : null;\r\n    const chestDef = chest ? manifestService.getItem(chest.hash) : null;\r\n    const legsDef = legs ? manifestService.getItem(legs.hash) : null;\r\n    const classItemDef = classItem ? manifestService.getItem(classItem.hash) : null;\r\n\r\n    // Build armor object for mod distribution\r\n    const armor = {\r\n        helmet: helmet,\r\n        arms: gauntlets,\r\n        chest: chest,\r\n        legs: legs,\r\n        classItem: classItem\r\n    };\r\n\r\n    // Use shared utility to distribute mods correctly\r\n    const { modGroups, armorCosmetics } = distributeLoadoutMods(loadout, armor);\r\n\r\n    // Helper to render compact mods for a slot (3x2 or 2x3 grid pods)\r\n    const renderCompactMods = (slotMods: number[], ornament: any = null, shader: any = null) => {\r\n        const { mainStat, secondaryStat, others } = categorizeMods(slotMods);\r\n\r\n        const renderCosmeticPod = (hash: number | null) => {\r\n            const def = hash ? manifestService.getItem(hash) : null;\r\n            if (!def) return <div className=\"mod-pod cosmetic-pod placeholder-pod\" />;\r\n\r\n            return (\r\n                <div key={hash} className=\"mod-pod cosmetic-pod\" onMouseEnter={() => setHoveredItemHash(hash)} onMouseLeave={() => setHoveredItemHash(null)}>\r\n                    <img src={getBungieUrl((def as any).displayProperties?.icon || '')} alt=\"\" />\r\n                </div>\r\n            );\r\n        };\r\n\r\n        const renderModPod = (hash: number) => {\r\n            const def = manifestService.getItem(hash);\r\n            if (!def) return null;\r\n            return (\r\n                <div key={hash} className=\"mod-pod\" onMouseEnter={() => setHoveredItemHash(hash)} onMouseLeave={() => setHoveredItemHash(null)}>\r\n                    <img src={getBungieUrl((def as any).displayProperties?.icon || '')} alt=\"\" />\r\n                </div>\r\n            );\r\n        };\r\n\r\n        return (\r\n            <div className=\"armor-mods-pod-grid\">\r\n                {/* 1. Shader (Required Slot) */}\r\n                {renderCosmeticPod(shader?.hash)}\r\n\r\n                {/* 2. Ornament (Required Slot) */}\r\n                {renderCosmeticPod(ornament?.hash)}\r\n\r\n                {/* 3. Main Stat (Only if present) */}\r\n                {mainStat && renderModPod(mainStat)}\r\n\r\n                {/* 4. Secondary Stat (Only if present) */}\r\n                {secondaryStat && renderModPod(secondaryStat)}\r\n\r\n                {/* 5+. Others */}\r\n                {others.map((h) => renderModPod(h))}\r\n            </div>\r\n        );\r\n    };\r\n\r\n\r\n\r\n    const helmetCosmetics = {\r\n        ornament: armorCosmetics.helmet?.ornament ? manifestService.getItem(armorCosmetics.helmet.ornament) : null,\r\n        shader: armorCosmetics.helmet?.shader ? manifestService.getItem(armorCosmetics.helmet.shader) : null\r\n    };\r\n    const gauntletsCosmetics = {\r\n        ornament: armorCosmetics.arms?.ornament ? manifestService.getItem(armorCosmetics.arms.ornament) : null,\r\n        shader: armorCosmetics.arms?.shader ? manifestService.getItem(armorCosmetics.arms.shader) : null\r\n    };\r\n    const chestCosmetics = {\r\n        ornament: armorCosmetics.chest?.ornament ? manifestService.getItem(armorCosmetics.chest.ornament) : null,\r\n        shader: armorCosmetics.chest?.shader ? manifestService.getItem(armorCosmetics.chest.shader) : null\r\n    };\r\n    const legsCosmetics = {\r\n        ornament: armorCosmetics.legs?.ornament ? manifestService.getItem(armorCosmetics.legs.ornament) : null,\r\n        shader: armorCosmetics.legs?.shader ? manifestService.getItem(armorCosmetics.legs.shader) : null\r\n    };\r\n    const classItemCosmetics = {\r\n        ornament: armorCosmetics.classItem?.ornament ? manifestService.getItem(armorCosmetics.classItem.ornament) : null,\r\n        shader: armorCosmetics.classItem?.shader ? manifestService.getItem(armorCosmetics.classItem.shader) : null\r\n    };\r\n\r\n\r\n    const kineticDef = kinetic ? manifestService.getItem(kinetic.hash) : null;\r\n    const energyDef = energy ? manifestService.getItem(energy.hash) : null;\r\n    const powerDef = power ? manifestService.getItem(power.hash) : null;\r\n\r\n    // Get background image from subclass or use default\r\n    const primaryIcon = subclassDef ? getBungieUrl(subclassDef.screenshot || subclassDef.displayProperties?.icon || '') : null;\r\n\r\n    return (\r\n        <div\r\n            className={`dim-loadout-viewer synergy-build-overlay context-dim-page ${isUiVisible ? '' : 'synergy-build-overlay--ui-hidden'}`}\r\n            data-element={elementName}\r\n            onMouseMove={handleMouseMove}\r\n            style={{\r\n                '--parallax-x': mousePos.x,\r\n                '--parallax-y': mousePos.y\r\n            } as any}\r\n        >\r\n            {/* Service Alert Notification */}\r\n            {notification && (\r\n                <div className=\"vault-service-alert animate-slide-up\">\r\n                    <div className=\"service-alert-content\">\r\n                        <div className=\"service-alert-icon\">\r\n                            <svg viewBox=\"0 0 24 24\" width=\"18\" height=\"18\" fill=\"currentColor\">\r\n                                <path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z\" />\r\n                            </svg>\r\n                        </div>\r\n                        <div className=\"service-alert-text\">\r\n                            <span className=\"alert-bold\">SERVICE ALERT</span>\r\n                            <span className=\"alert-message\">{notification}</span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Background Image */}\r\n            {primaryIcon && (\r\n                <div className=\"synergy-build-overlay__bg\" ref={bgRef}>\r\n                    <div className=\"synergy-build-overlay__pattern\" />\r\n                    <img src={primaryIcon} className=\"synergy-build-overlay__screenshot\" alt=\"\" />\r\n                    <div className=\"synergy-build-overlay__vignette\" />\r\n                </div>\r\n            )}\r\n\r\n            {/* Close Button Top-Left */}\r\n            <button className=\"synergy-build-overlay__close-top-left\" onClick={() => navigate('/agent-wake')}>\r\n                âœ•\r\n            </button>\r\n\r\n            {/* Header Top-Right */}\r\n            <div className=\"synergy-build-overlay__header-top-right\">\r\n                <div className=\"synergy-build-overlay__title-area\">\r\n                    <h1 className=\"synergy-build-overlay__title-large\">{loadout.name}</h1>\r\n                    <div className=\"synergy-build-overlay__subtitle-caps\">\r\n                        {className.toUpperCase()} // {subclassDef?.displayProperties?.name?.toUpperCase() || 'UNKNOWN SUBCLASS'}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Main Content - Full 2-Column Build Layout */}\r\n            <div className=\"synergy-build-overlay__content\">\r\n                {/* 1. Super Section (Column 1) */}\r\n                <div className=\"build-section build-section--super\">\r\n                    {buildIcons.super && (\r\n                        <div className=\"super-node-large\">\r\n                            <img\r\n                                src={buildIcons.super}\r\n                                alt=\"Super Icon\"\r\n                                onMouseEnter={() => setHoveredItemHash(buildIcons.superHash || null)}\r\n                                onMouseLeave={() => setHoveredItemHash(null)}\r\n                            />\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                {/* 2. Middle Section (Column 2) - Abilities, Aspects, Fragments, Gear */}\r\n                <div className=\"build-section--middle\">\r\n                    <div className=\"build-section--middle__top-row\">\r\n                        {/* Abilities Section */}\r\n                        <div className=\"node-section section-abilities\">\r\n                            <div className=\"node-section-header-prefixed\">| ABILITIES</div>\r\n                            <div className=\"node-section-content\">\r\n                                {buildIcons.classAbility && (\r\n                                    <SubclassNode\r\n                                        type=\"square\"\r\n                                        size=\"normal\"\r\n                                        icon={buildIcons.classAbility}\r\n                                        element={elementName as any}\r\n                                        status=\"active\"\r\n                                        onMouseEnter={() => setHoveredItemHash(buildIcons.classAbilityHash || null)}\r\n                                        onMouseLeave={() => setHoveredItemHash(null)}\r\n                                    />\r\n                                )}\r\n                                {buildIcons.jump && (\r\n                                    <SubclassNode\r\n                                        type=\"square\"\r\n                                        size=\"normal\"\r\n                                        icon={buildIcons.jump}\r\n                                        element={elementName as any}\r\n                                        status=\"active\"\r\n                                        onMouseEnter={() => setHoveredItemHash(buildIcons.jumpHash || null)}\r\n                                        onMouseLeave={() => setHoveredItemHash(null)}\r\n                                    />\r\n                                )}\r\n                                {buildIcons.melee && (\r\n                                    <SubclassNode\r\n                                        type=\"square\"\r\n                                        size=\"normal\"\r\n                                        icon={buildIcons.melee}\r\n                                        element={elementName as any}\r\n                                        status=\"active\"\r\n                                        onMouseEnter={() => setHoveredItemHash(buildIcons.meleeHash || null)}\r\n                                        onMouseLeave={() => setHoveredItemHash(null)}\r\n                                    />\r\n                                )}\r\n                                {buildIcons.grenade && (\r\n                                    <SubclassNode\r\n                                        type=\"square\"\r\n                                        size=\"normal\"\r\n                                        icon={buildIcons.grenade}\r\n                                        element={elementName as any}\r\n                                        status=\"active\"\r\n                                        onMouseEnter={() => setHoveredItemHash(buildIcons.grenadeHash || null)}\r\n                                        onMouseLeave={() => setHoveredItemHash(null)}\r\n                                    />\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Aspects Section */}\r\n                        <div className=\"node-section section-aspects\">\r\n                            <div className=\"node-section-header-prefixed\">| ASPECTS</div>\r\n                            <div className=\"node-section-content\">\r\n                                {buildIcons.aspects.map((aspect, i) => (\r\n                                    <SubclassNode\r\n                                        key={i}\r\n                                        type=\"square\"\r\n                                        size=\"normal\"\r\n                                        icon={aspect.icon}\r\n                                        element={elementName as any}\r\n                                        status=\"active\"\r\n                                        onMouseEnter={() => setHoveredItemHash(aspect.hash || null)}\r\n                                        onMouseLeave={() => setHoveredItemHash(null)}\r\n                                    />\r\n                                ))}\r\n                                {/* Transcendence inline if Prismatic */}\r\n                                {elementName === 'prismatic' && buildIcons.transcendence && (\r\n                                    <SubclassNode\r\n                                        type=\"square\"\r\n                                        size=\"normal\"\r\n                                        icon={buildIcons.transcendence}\r\n                                        element={elementName as any}\r\n                                        status=\"active\"\r\n                                        onMouseEnter={() => setHoveredItemHash(buildIcons.transcendenceHash || null)}\r\n                                        onMouseLeave={() => setHoveredItemHash(null)}\r\n                                    />\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"build-section--middle__bottom-row\">\r\n                        {/* Fragments Section */}\r\n                        <div className=\"node-section section-fragments\">\r\n                            <div className=\"node-section-header-prefixed\">| FRAGMENTS</div>\r\n                            <div className=\"synergy-build-overlay__fragments-grid\">\r\n                                {buildIcons.fragments.map((fragment, i) => (\r\n                                    <SubclassNode\r\n                                        key={i}\r\n                                        type=\"square\"\r\n                                        size=\"small\"\r\n                                        icon={fragment.icon}\r\n                                        element={elementName as any}\r\n                                        status=\"active\"\r\n                                        onMouseEnter={() => setHoveredItemHash(fragment.hash || null)}\r\n                                        onMouseLeave={() => setHoveredItemHash(null)}\r\n                                    />\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* 3. Loadout & Gear Section row */}\r\n                    <div className=\"build-section--middle__gear-row\">\r\n                        <div className=\"node-section section-gear\">\r\n                            <div className=\"node-section-header-prefixed\">| LOADOUT & GEAR</div>\r\n                            <div className=\"synergy-build-overlay__gear-horizontal-grid\">\r\n                                {/* Weapons */}\r\n                                {[\r\n                                    { def: kineticDef, item: kinetic },\r\n                                    { def: energyDef, item: energy },\r\n                                    { def: powerDef, item: power }\r\n                                ].map((w, i) => w.def && (\r\n                                    <div key={i} className=\"gear-item-horizontal\" onMouseEnter={() => setHoveredItemHash(w.def?.hash || null)} onMouseLeave={() => setHoveredItemHash(null)}>\r\n                                        <RichItemIcon hash={w.def.hash} instance={w.item} />\r\n                                        <div className=\"gear-item-info\">\r\n                                            <span className=\"build-item__label--compact\">{w.def.displayProperties?.name}</span>\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n\r\n                                {/* Armor pieces */}\r\n                                {[\r\n                                    { def: helmetDef, group: modGroups.helmet, cosmetics: helmetCosmetics, itemData: helmet },\r\n                                    { def: gauntletsDef, group: modGroups.arms, cosmetics: gauntletsCosmetics, itemData: gauntlets },\r\n                                    { def: chestDef, group: modGroups.chest, cosmetics: chestCosmetics, itemData: chest },\r\n                                    { def: legsDef, group: modGroups.legs, cosmetics: legsCosmetics, itemData: legs },\r\n                                    { def: classItemDef, group: modGroups.classItem, cosmetics: classItemCosmetics, itemData: classItem }\r\n                                ].map((item, idx) => item.def && (\r\n                                    <div key={idx} className=\"gear-item-horizontal\" onMouseEnter={() => setHoveredItemHash(item.def?.hash || null)} onMouseLeave={() => setHoveredItemHash(null)}>\r\n                                        <RichItemIcon hash={item.def.hash} instance={item.itemData} />\r\n                                        <div className=\"gear-item-info\">\r\n                                            <span className=\"build-item__label--compact\">{item.def.displayProperties?.name}</span>\r\n                                            {renderCompactMods(item.group, item.cosmetics.ornament, item.cosmetics.shader)}\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Build Description Panel */}\r\n            <div className={`synergy-build-overlay__lore-panel ${isLoreOpen ? 'synergy-build-overlay__lore-panel--open' : ''}`}>\r\n                <div className=\"lore-panel__header\">\r\n                    <h2 className=\"lore-panel__title\">{loadout.name}</h2>\r\n                    <div className=\"lore-panel__subtitle\">\r\n                        {className} // {subclassDef?.displayProperties?.name || 'Custom Build'}\r\n                    </div>\r\n                </div>\r\n                <div className=\"lore-panel__content\">\r\n                    {loadout.notes || 'This is a DIM loadout. No description provided.'}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Bottom Action Bar */}\r\n            <div className=\"synergy-build-overlay__footer-bar\">\r\n                <div className=\"key-prompt\" onClick={handleSaveBuild}>\r\n                    <span className=\"key-cap\">D</span>\r\n                    <span className=\"key-label\">Save Build</span>\r\n                </div>\r\n                <div className=\"key-prompt\" onClick={() => setIsUiVisible(!isUiVisible)}>\r\n                    <span className=\"key-cap\">Ctrl</span>\r\n                    <span className=\"key-label\">Hide Menu</span>\r\n                </div>\r\n                <div className=\"key-prompt\" onClick={() => navigate('/agent-wake')}>\r\n                    <span className=\"key-cap\">Esc</span>\r\n                    <span className=\"key-label\">Back to Agent</span>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Rich Tooltip Portal */}\r\n            {hoveredItemHash && (\r\n                <div className=\"fixed-tooltip-container\">\r\n                    <RichTooltip\r\n                        item={manifestService.getItem(hoveredItemHash)}\r\n                    />\r\n                </div>\r\n            )}\r\n\r\n            <NamingModal\r\n                isOpen={isNamingModalOpen}\r\n                message=\"Enter a name for this DIM imported configuration:\"\r\n                defaultValue={loadout?.name || 'Custom Build'}\r\n                onConfirm={confirmSaveBuild}\r\n                onCancel={() => setIsNamingModalOpen(false)}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default DIMLoadoutViewerPage;\r\n"],"names":["NamingModal","isOpen","title","message","defaultValue","onConfirm","onCancel","name","setName","useState","inputRef","useRef","useEffect","handleModalClick","handleModalContextMenu","e","handleGlobalContextMenu","handleKeyDown","jsx","jsxs","MouseRightIcon","MouseLeftIcon","ELEMENT_NAMES","CLASS_NAMES","PRISMATIC_HASHES","DIMLoadoutViewerPage","navigate","useNavigate","searchParams","useSearchParams","loadout","setLoadout","loading","setLoading","error","setError","isLoreOpen","setIsLoreOpen","isUiVisible","setIsUiVisible","hoveredItemHash","setHoveredItemHash","isNamingModalOpen","setIsNamingModalOpen","notification","setNotification","notificationTimeout","setNotificationTimeout","bgRef","mousePos","setMousePos","showNotification","timeout","url","loadoutData","loadoutLinkService","err","errorLog","handler","activeEl","p","handleSaveBuild","handleMouseMove","clientX","clientY","innerWidth","innerHeight","x","y","confirmSaveBuild","buildName","subclassItem","item","manifestService","BUCKET_HASHES","subclassDef","damageType","element","getSocketHash","socketIndex","aspectHashes","fragmentHashes","idxStr","hash","idx","def","category","typeName","exoticWeapon","exoticArmor","armorMods","isGameplayMod","pDef","plugCat","bucketMods","h","template","buildService","LoadingScreen","elementName","className","getSocketItem","superDef","jumpDef","classAbilityDef","meleeDef","grenadeDef","allAspects","allFragments","discoveredTranscendence","getBungieUrl","buildIcons","helmet","i","gauntlets","chest","legs","classItem","kinetic","energy","power","helmetDef","gauntletsDef","chestDef","legsDef","classItemDef","armor","modGroups","armorCosmetics","distributeLoadoutMods","renderCompactMods","slotMods","ornament","shader","mainStat","secondaryStat","others","categorizeMods","renderCosmeticPod","renderModPod","helmetCosmetics","gauntletsCosmetics","chestCosmetics","legsCosmetics","classItemCosmetics","kineticDef","energyDef","powerDef","primaryIcon","SubclassNode","aspect","fragment","w","RichItemIcon","RichTooltip"],"mappings":"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"}