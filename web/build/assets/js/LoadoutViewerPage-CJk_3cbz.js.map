{"version":3,"file":"LoadoutViewerPage-CJk_3cbz.js","sources":["../../../../src/pages/LoadoutViewerPage.tsx"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { useNavigate, useParams } from 'react-router-dom';\r\nimport { manifestService } from '../services/bungie/manifest.service';\r\nimport { loadoutLinkService } from '../services/bungie/loadout-link.service';\r\nimport { BUCKET_HASHES } from '../config/bungie.config';\r\nimport { getBungieUrl } from '../utils/url-helper';\r\nimport { LoadingScreen } from '../components/common/Loader';\r\nimport { SubclassNode } from '../components/builder/SubclassNode';\r\nimport { RichTooltip } from '../components/builder/RichTooltip';\r\nimport { distributeLoadoutMods } from '../utils/loadout-mods.utils';\r\nimport { errorLog } from '../utils/logger';\r\nimport { RichItemIcon } from '../components/common/RichItemIcon';\r\nimport { categorizeMods } from '../utils/loadout-mods.utils';\r\nimport './LoadoutViewerPage.css';\r\n\r\nconst ELEMENT_NAMES: Record<number, string> = {\r\n    1: 'kinetic',\r\n    2: 'arc',\r\n    3: 'solar',\r\n    4: 'void',\r\n    6: 'stasis',\r\n    7: 'strand',\r\n};\r\n\r\nconst CLASS_NAMES: Record<number, string> = {\r\n    0: 'Titan',\r\n    1: 'Hunter',\r\n    2: 'Warlock',\r\n};\r\n\r\nexport function LoadoutViewerPage() {\r\n    const { encodedData } = useParams<{ encodedData?: string }>();\r\n    const navigate = useNavigate();\r\n    const [activeLoadout, setActiveLoadout] = useState<any>(null);\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    const [error, setError] = useState<string | null>(null);\r\n    const [isManifestLoaded, setIsManifestLoaded] = useState(false);\r\n    const [isMenuVisible, setIsMenuVisible] = useState(true);\r\n    const [hoveredItemHash, setHoveredItemHash] = useState<number | null>(null);\r\n    const [mousePos, setMousePos] = useState({ x: 0, y: 0 });\r\n\r\n    // Handle mouse move for parallax\r\n    const handleMouseMove = (e: React.MouseEvent) => {\r\n        const { clientX, clientY } = e;\r\n        const { innerWidth, innerHeight } = window;\r\n        // Normalized values from -0.5 to 0.5\r\n        const x = (clientX / innerWidth) - 0.5;\r\n        const y = (clientY / innerHeight) - 0.5;\r\n        setMousePos({ x, y });\r\n    };\r\n\r\n    // Notification banner state\r\n    const [notification, setNotification] = useState<string | null>(null);\r\n    const [notificationTimeout, setNotificationTimeout] = useState<NodeJS.Timeout | null>(null);\r\n\r\n    // Show notification banner\r\n    const showNotification = (message: string) => {\r\n        if (notificationTimeout) clearTimeout(notificationTimeout);\r\n        setNotification(message);\r\n        const timeout = setTimeout(() => setNotification(null), 2500);\r\n        setNotificationTimeout(timeout);\r\n    };\r\n\r\n    // Ensure manifest is loaded\r\n    useEffect(() => {\r\n        const loadManifest = async () => {\r\n            try {\r\n                if (!manifestService.isLoaded()) {\r\n                    await manifestService.load();\r\n                }\r\n                setIsManifestLoaded(true);\r\n            } catch (err) {\r\n                errorLog('LoadoutViewerPage', 'Failed to load manifest:', err);\r\n                showNotification('Failed to load Destiny 2 database');\r\n            }\r\n        };\r\n        loadManifest();\r\n    }, []);\r\n\r\n    // Scroll to top when loadout changes\r\n    useEffect(() => {\r\n        if (activeLoadout) {\r\n            window.scrollTo({ top: 0, behavior: 'smooth' });\r\n        }\r\n    }, [activeLoadout]);\r\n\r\n    // Keyboard shortcuts\r\n    useEffect(() => {\r\n        const handleKeyDown = async (e: KeyboardEvent) => {\r\n            const activeEl = document.activeElement;\r\n            const isTyping = activeEl && (\r\n                activeEl.tagName === 'INPUT' ||\r\n                activeEl.tagName === 'TEXTAREA' ||\r\n                (activeEl as HTMLElement).isContentEditable\r\n            );\r\n\r\n            if (isTyping) return;\r\n\r\n            // CTRL - Toggle menu visibility\r\n            if (e.key === 'Control') {\r\n                setIsMenuVisible(p => !p);\r\n            }\r\n            // ESC - Back to agent\r\n            if (e.key === 'Escape') {\r\n                navigate('/agent-wake');\r\n            }\r\n            // G - Copy DIM link\r\n            if ((e.key === 'g' || e.key === 'G') && activeLoadout?.source !== 'exoengine') {\r\n                handleCopyDIMLink();\r\n            }\r\n        };\r\n\r\n        window.addEventListener('keydown', handleKeyDown);\r\n        return () => window.removeEventListener('keydown', handleKeyDown);\r\n    }, [activeLoadout, navigate]);\r\n\r\n    // Copy ExoEngine link\r\n    const handleCopyExoEngineLink = async () => {\r\n        if (!activeLoadout) return;\r\n\r\n        try {\r\n            const link = await loadoutLinkService.generateExoEngineLink(activeLoadout);\r\n            await navigator.clipboard.writeText(link);\r\n            showNotification('Link copied to clipboard');\r\n        } catch (err) {\r\n            errorLog('LoadoutViewerPage', 'Failed to copy link:', err);\r\n            showNotification('Failed to copy link');\r\n        }\r\n    };\r\n\r\n    // Copy DIM link\r\n    const handleCopyDIMLink = async () => {\r\n        if (!activeLoadout) return;\r\n\r\n        try {\r\n            const link = loadoutLinkService.generateDIMCompatibleLink(activeLoadout);\r\n            navigator.clipboard.writeText(link);\r\n            showNotification('Link copied to clipboard');\r\n        } catch (err) {\r\n            errorLog('LoadoutViewerPage', 'Failed to copy DIM link:', err);\r\n            showNotification('Failed to copy link');\r\n        }\r\n    };\r\n\r\n\r\n\r\n    // Auto-parse\r\n    useEffect(() => {\r\n        if (encodedData && isManifestLoaded) {\r\n            (async () => {\r\n                try {\r\n                    const decoded = await loadoutLinkService.parseLoadoutLink(`/loadout/${encodedData}`);\r\n                    setActiveLoadout(decoded);\r\n                    setIsLoading(false);\r\n                } catch (err) {\r\n                    errorLog('LoadoutViewerPage', 'Full decode failed:', err);\r\n                    setError('This loadout link is invalid or expired');\r\n                    setIsLoading(false);\r\n                }\r\n            })();\r\n        } else if (!encodedData && isManifestLoaded) {\r\n            setIsLoading(false);\r\n        }\r\n    }, [encodedData, isManifestLoaded]);\r\n\r\n    if (error) {\r\n        return (\r\n            <div className=\"loadout-viewer-error\">\r\n                <div className=\"error-card glass-panel\">\r\n                    <h2>SYSTEM ERROR</h2>\r\n                    <p>{error}</p>\r\n                    <button className=\"btn btn-primary\" onClick={() => navigate('/generator')}>Return to Tactical Hub</button>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (isLoading || !isManifestLoaded) {\r\n        return <LoadingScreen message=\"Syncing Tactical Data...\" />;\r\n    }\r\n\r\n    const gear: Record<string, any> = {};\r\n    activeLoadout.equipped.forEach((item: any) => {\r\n        const def = manifestService.getItem(item.hash);\r\n        if (!def) return;\r\n        const bucket = def.inventory?.bucketTypeHash;\r\n        if (bucket === BUCKET_HASHES.KINETIC_WEAPONS) gear.kinetic = item;\r\n        else if (bucket === BUCKET_HASHES.ENERGY_WEAPONS) gear.energy = item;\r\n        else if (bucket === BUCKET_HASHES.POWER_WEAPONS) gear.power = item;\r\n        else if (bucket === BUCKET_HASHES.HELMET) gear.helmet = item;\r\n        else if (bucket === BUCKET_HASHES.GAUNTLETS) gear.arms = item;\r\n        else if (bucket === BUCKET_HASHES.CHEST_ARMOR) gear.chest = item;\r\n        else if (bucket === BUCKET_HASHES.LEG_ARMOR) gear.legs = item;\r\n        else if (bucket === BUCKET_HASHES.CLASS_ARMOR) gear.classItem = item;\r\n        else if (bucket === BUCKET_HASHES.SUBCLASS) gear.subclass = item;\r\n    });\r\n\r\n    // Helper for build summary icons\r\n    const getIconData = (item: any) => {\r\n        if (!item) return { icon: '', hash: 0 };\r\n        const def = manifestService.getItem(item.hash);\r\n        return {\r\n            icon: getBungieUrl(def?.displayProperties?.icon || ''),\r\n            hash: item.hash\r\n        };\r\n    };\r\n\r\n    const buildIcons = {\r\n        subclass: getIconData(gear.subclass),\r\n        super: { icon: '', hash: 0 },\r\n        abilities: [] as any[],\r\n        aspects: [] as any[],\r\n        fragments: [] as any[]\r\n    };\r\n\r\n    // Subclass details\r\n    const subclassDef = gear.subclass ? manifestService.getItem(gear.subclass.hash) : null;\r\n    const damageType = subclassDef?.talentGrid?.hudDamageType || 3;\r\n    const elementName = ELEMENT_NAMES[damageType] || 'solar';\r\n\r\n    if (gear.subclass?.socketOverrides && subclassDef) {\r\n        const indexToGroup: Record<number, string> = {};\r\n        const HASH_TO_GROUP: Record<number, string> = {\r\n            457473665: 'SUPER',\r\n            2047681910: 'ASPECTS',\r\n            2140934067: 'ASPECTS',\r\n            3400923910: 'ASPECTS',\r\n            764703411: 'ASPECTS',\r\n            271461480: 'FRAGMENTS',\r\n            1313488945: 'FRAGMENTS',\r\n            2819965312: 'FRAGMENTS',\r\n            193371309: 'FRAGMENTS',\r\n            4112185160: 'FRAGMENTS',\r\n            309722977: 'CLASS_ABILITIES',\r\n            3218807805: 'CLASS_ABILITIES',\r\n            1905270138: 'ABILITIES', // Transcendence\r\n        };\r\n\r\n        if (subclassDef.sockets?.socketCategories) {\r\n            subclassDef.sockets.socketCategories.forEach((cat: any) => {\r\n                const group = HASH_TO_GROUP[cat.socketCategoryHash];\r\n                if (group) {\r\n                    cat.socketIndexes.forEach((idx: number) => {\r\n                        indexToGroup[idx] = group;\r\n                    });\r\n                }\r\n            });\r\n        }\r\n\r\n        Object.entries(gear.subclass.socketOverrides).forEach(([idxStr, hash]) => {\r\n            const idx = parseInt(idxStr);\r\n            const def = manifestService.getItem(hash as number);\r\n            if (!def) return;\r\n\r\n            const icon = getBungieUrl(def.displayProperties.icon);\r\n            const data: any = { icon: icon || '', hash: hash as number, idx };\r\n            const group = indexToGroup[idx];\r\n\r\n            const category = (def.plug?.plugCategoryIdentifier || \"\").toLowerCase();\r\n            const name = (def.displayProperties?.name || \"\").toLowerCase();\r\n\r\n            if (group === 'SUPER') {\r\n                buildIcons.super = data;\r\n            } else if (group === 'ASPECTS') {\r\n                if (!buildIcons.aspects.some(a => a.hash === data.hash)) buildIcons.aspects.push(data);\r\n            } else if (group === 'FRAGMENTS') {\r\n                if (!buildIcons.fragments.some(f => f.hash === data.hash)) buildIcons.fragments.push(data);\r\n            } else if (group === 'CLASS_ABILITIES' || group === 'ABILITIES' || category.includes('.ability.')) {\r\n                // Determine order priority: Class -> Jump -> Melee -> Grenade\r\n                let priority = 10;\r\n                if (category.includes('class') || name.includes('rift') || name.includes('dodge') || name.includes('barricade')) priority = 0;\r\n                else if (category.includes('movement') || category.includes('jump')) priority = 1;\r\n                else if (category.includes('melee')) priority = 2;\r\n                else if (category.includes('grenade')) priority = 3;\r\n\r\n                data.priority = priority;\r\n\r\n                if (!buildIcons.abilities.some(a => a.hash === data.hash) && buildIcons.super.hash !== data.hash) {\r\n                    buildIcons.abilities.push(data);\r\n                }\r\n            }\r\n        });\r\n\r\n        // Ensure abilities are sorted by priority\r\n        buildIcons.abilities.sort((a, b) => (a.priority ?? 99) - (b.priority ?? 99));\r\n    } else if (gear.subclass?.socketOverrides) {\r\n        // Fallback for cases where subclassDef is missing or doesn't use categories\r\n        Object.entries(gear.subclass.socketOverrides).forEach(([idxStr, hash]) => {\r\n            const idx = parseInt(idxStr);\r\n            const def = manifestService.getItem(hash as number);\r\n            if (!def) return;\r\n\r\n            const icon = getBungieUrl(def.displayProperties.icon);\r\n            const data: any = { icon: icon || '', hash: hash as number, idx };\r\n            const category = (def.plug?.plugCategoryIdentifier || \"\").toLowerCase();\r\n            const typeName = (def.itemTypeDisplayName || \"\").toLowerCase();\r\n            const name = (def.displayProperties?.name || \"\").toLowerCase();\r\n\r\n            if (category.includes('.super') || idx === 0) {\r\n                if (category.includes('.super') || !buildIcons.super.hash) buildIcons.super = data;\r\n                if (category.includes('.super')) return;\r\n            }\r\n\r\n            if (category.includes('aspect') || typeName.includes('aspect')) {\r\n                if (!buildIcons.aspects.some(a => a.hash === data.hash)) buildIcons.aspects.push(data);\r\n            } else if (category.includes('fragment') || category.includes('facet') || name.includes('facet of')) {\r\n                if (!buildIcons.fragments.some(f => f.hash === data.hash)) buildIcons.fragments.push(data);\r\n            } else {\r\n                let priority = 10;\r\n                if (category.includes('class') || name.includes('rift') || name.includes('dodge') || name.includes('barricade')) priority = 0;\r\n                else if (category.includes('movement') || category.includes('jump')) priority = 1;\r\n                else if (category.includes('melee')) priority = 2;\r\n                else if (category.includes('grenade')) priority = 3;\r\n                data.priority = priority;\r\n                if (!buildIcons.abilities.some(a => a.hash === data.hash) && buildIcons.super.hash !== data.hash) {\r\n                    buildIcons.abilities.push(data);\r\n                }\r\n            }\r\n        });\r\n        buildIcons.abilities.sort((a, b) => (a.priority ?? 99) - (b.priority ?? 99));\r\n    }\r\n\r\n    const modGroupsData = distributeLoadoutMods(activeLoadout, gear);\r\n    const { modGroups, armorCosmetics } = modGroupsData;\r\n\r\n    // Helper to render compact mods for a slot\r\n    const renderCompactMods = (slotMods: number[], ornament: any = null, shader: any = null) => {\r\n        const { mainStat, secondaryStat, others } = categorizeMods(slotMods);\r\n\r\n        const renderCosmeticPod = (hash: number | null) => {\r\n            const def = hash ? manifestService.getItem(hash) : null;\r\n            if (!def) return <div className=\"mod-pod cosmetic-pod placeholder-pod\" />;\r\n\r\n            return (\r\n                <div key={hash} className=\"mod-pod cosmetic-pod\" onMouseEnter={() => setHoveredItemHash(hash)} onMouseLeave={() => setHoveredItemHash(null)}>\r\n                    <img src={getBungieUrl((def as any).displayProperties?.icon || '')} alt=\"\" />\r\n                </div>\r\n            );\r\n        };\r\n\r\n        const renderModPod = (hash: number) => {\r\n            const def = manifestService.getItem(hash);\r\n            if (!def) return null;\r\n            return (\r\n                <div key={hash} className=\"mod-pod\" onMouseEnter={() => setHoveredItemHash(hash)} onMouseLeave={() => setHoveredItemHash(null)}>\r\n                    <img src={getBungieUrl((def as any).displayProperties?.icon || '')} alt=\"\" />\r\n                </div>\r\n            );\r\n        };\r\n\r\n        return (\r\n            <div className=\"armor-mods-pod-grid\">\r\n                {renderCosmeticPod(shader?.hash)}\r\n                {renderCosmeticPod(ornament?.hash)}\r\n                {mainStat && renderModPod(mainStat)}\r\n                {secondaryStat && renderModPod(secondaryStat)}\r\n                {others.map((h) => renderModPod(h))}\r\n            </div>\r\n        );\r\n    };\r\n\r\n    const helmetCosmetics = {\r\n        ornament: armorCosmetics.helmet?.ornament ? manifestService.getItem(armorCosmetics.helmet.ornament) : null,\r\n        shader: armorCosmetics.helmet?.shader ? manifestService.getItem(armorCosmetics.helmet.shader) : null\r\n    };\r\n    const armsCosmetics = {\r\n        ornament: armorCosmetics.arms?.ornament ? manifestService.getItem(armorCosmetics.arms.ornament) : null,\r\n        shader: armorCosmetics.arms?.shader ? manifestService.getItem(armorCosmetics.arms.shader) : null\r\n    };\r\n    const chestCosmetics = {\r\n        ornament: armorCosmetics.chest?.ornament ? manifestService.getItem(armorCosmetics.chest.ornament) : null,\r\n        shader: armorCosmetics.chest?.shader ? manifestService.getItem(armorCosmetics.chest.shader) : null\r\n    };\r\n    const legsCosmetics = {\r\n        ornament: armorCosmetics.legs?.ornament ? manifestService.getItem(armorCosmetics.legs.ornament) : null,\r\n        shader: armorCosmetics.legs?.shader ? manifestService.getItem(armorCosmetics.legs.shader) : null\r\n    };\r\n    const classItemCosmetics = {\r\n        ornament: armorCosmetics.classItem?.ornament ? manifestService.getItem(armorCosmetics.classItem.ornament) : null,\r\n        shader: armorCosmetics.classItem?.shader ? manifestService.getItem(armorCosmetics.classItem.shader) : null\r\n    };\r\n\r\n    return (\r\n        <div\r\n            className={`loadout-viewer-page synergy-build-overlay synergy-build-overlay--${elementName as any} ${!isMenuVisible ? 'ui-hidden' : ''}`}\r\n            onMouseMove={handleMouseMove}\r\n            style={{\r\n                zIndex: 20000,\r\n                '--parallax-x': mousePos.x,\r\n                '--parallax-y': mousePos.y\r\n            } as any}\r\n        >\r\n            {/* Background Layer with Parallax */}\r\n            <div className=\"synergy-build-overlay__bg\">\r\n                <div className=\"synergy-build-overlay__pattern\" />\r\n                <img\r\n                    src={getBungieUrl(subclassDef?.screenshot || '')}\r\n                    alt=\"\"\r\n                    className=\"synergy-build-overlay__screenshot\"\r\n                />\r\n                <div className=\"synergy-build-overlay__vignette\" />\r\n            </div>\r\n\r\n            {notification && (\r\n                <div className=\"vault-service-alert animate-slide-up\">\r\n                    <div className=\"service-alert-content\">\r\n                        <div className=\"service-alert-icon\">\r\n                            <svg viewBox=\"0 0 24 24\" width=\"18\" height=\"18\" fill=\"currentColor\">\r\n                                <path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z\" />\r\n                            </svg>\r\n                        </div>\r\n                        <div className=\"service-alert-text\">\r\n                            <span className=\"alert-bold\">INFO</span>\r\n                            <span className=\"alert-message\">{notification}</span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            <div className=\"synergy-build-overlay__header-top-right\">\r\n                <div className=\"synergy-build-overlay__title-area\">\r\n                    <h1 className=\"synergy-build-overlay__title-large\">{activeLoadout.name || 'TACTICAL CONFIGURATION'}</h1>\r\n                    <div className=\"synergy-build-overlay__subtitle-caps\">\r\n                        {CLASS_NAMES[activeLoadout.classType].toUpperCase()} // {subclassDef?.displayProperties?.name?.toUpperCase() || 'UNKNOWN SUBCLASS'}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"synergy-build-overlay__content\">\r\n                <div className=\"build-section build-section--super\">\r\n                    {buildIcons.super.icon && (\r\n                        <div className=\"super-node-large\">\r\n                            <img\r\n                                src={buildIcons.super.icon}\r\n                                alt=\"Primary Ability\"\r\n                                onMouseEnter={() => setHoveredItemHash(buildIcons.super.hash || null)}\r\n                                onMouseLeave={() => setHoveredItemHash(null)}\r\n                            />\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                <div className=\"build-section--middle\">\r\n                    <div className=\"build-section--middle__top-row\">\r\n                        <div className=\"node-section section-abilities\">\r\n                            <div className=\"node-section-header-prefixed\">| ABILITIES</div>\r\n                            <div className=\"node-section-content\">\r\n                                {buildIcons.abilities.map((ability, i) => (\r\n                                    <SubclassNode\r\n                                        key={i}\r\n                                        type=\"square\"\r\n                                        size=\"normal\"\r\n                                        icon={ability.icon}\r\n                                        element={elementName as any}\r\n                                        status=\"active\"\r\n                                        onMouseEnter={() => setHoveredItemHash(ability.hash)}\r\n                                        onMouseLeave={() => setHoveredItemHash(null)}\r\n                                    />\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"node-section section-aspects\">\r\n                            <div className=\"node-section-header-prefixed\">| ASPECTS</div>\r\n                            <div className=\"node-section-content\">\r\n                                {buildIcons.aspects.map((aspect, i) => (\r\n                                    <SubclassNode\r\n                                        key={i}\r\n                                        type=\"square\"\r\n                                        size=\"normal\"\r\n                                        icon={aspect.icon}\r\n                                        element={elementName as any}\r\n                                        status=\"active\"\r\n                                        onMouseEnter={() => setHoveredItemHash(aspect.hash)}\r\n                                        onMouseLeave={() => setHoveredItemHash(null)}\r\n                                    />\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"build-section--middle__bottom-row\">\r\n                        <div className=\"node-section section-fragments\">\r\n                            <div className=\"node-section-header-prefixed\">| FRAGMENTS</div>\r\n                            <div className=\"synergy-build-overlay__fragments-grid\">\r\n                                {buildIcons.fragments.map((fragment, i) => (\r\n                                    <SubclassNode\r\n                                        key={i}\r\n                                        type=\"square\"\r\n                                        size=\"small\"\r\n                                        icon={fragment.icon}\r\n                                        element={elementName as any}\r\n                                        status=\"active\"\r\n                                        onMouseEnter={() => setHoveredItemHash(fragment.hash || null)}\r\n                                        onMouseLeave={() => setHoveredItemHash(null)}\r\n                                    />\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"build-section--middle__gear-row\">\r\n                        <div className=\"node-section section-gear\">\r\n                            <div className=\"node-section-header-prefixed\">| LOADOUT & GEAR</div>\r\n                            <div className=\"synergy-build-overlay__gear-horizontal-grid\">\r\n                                {[\r\n                                    { item: gear.kinetic, label: 'KINETIC' },\r\n                                    { item: gear.energy, label: 'ENERGY' },\r\n                                    { item: gear.power, label: 'POWER' }\r\n                                ].map((w, idx) => (\r\n                                    <div key={`weapon-${idx}`} className={`gear-item-horizontal ${!w.item ? 'gear-item--empty' : ''}`} onMouseEnter={() => w.item && setHoveredItemHash(w.item.hash)} onMouseLeave={() => setHoveredItemHash(null)}>\r\n                                        {w.item ? (\r\n                                            <>\r\n                                                <RichItemIcon hash={w.item.hash} instance={w.item} />\r\n                                                <div className=\"gear-item-info\">\r\n                                                    <span className=\"build-item__label--compact\">{manifestService.getItem(w.item.hash)?.displayProperties?.name}</span>\r\n                                                </div>\r\n                                            </>\r\n                                        ) : (\r\n                                            <div className=\"gear-placeholder\">\r\n                                                <div className=\"gear-placeholder__icon\" />\r\n                                                <span>{w.label} EMPTY</span>\r\n                                            </div>\r\n                                        )}\r\n                                    </div>\r\n                                ))}\r\n\r\n                                {[\r\n                                    { item: gear.helmet, group: modGroups.helmet, cosmetics: helmetCosmetics, label: 'HELMET' },\r\n                                    { item: gear.arms, group: modGroups.arms, cosmetics: armsCosmetics, label: 'GAUNTLETS' },\r\n                                    { item: gear.chest, group: modGroups.chest, cosmetics: chestCosmetics, label: 'CHEST' },\r\n                                    { item: gear.legs, group: modGroups.legs, cosmetics: legsCosmetics, label: 'LEGS' },\r\n                                    { item: gear.classItem, group: modGroups.classItem, cosmetics: classItemCosmetics, label: 'CLASS' }\r\n                                ].map((g, idx) => (\r\n                                    <div key={`armor-${idx}`} className={`gear-item-horizontal ${!g.item ? 'gear-item--empty' : ''}`} onMouseEnter={() => g.item && setHoveredItemHash(g.item.hash)} onMouseLeave={() => setHoveredItemHash(null)}>\r\n                                        {g.item ? (\r\n                                            <>\r\n                                                <RichItemIcon hash={g.item.hash} instance={g.item} />\r\n                                                <div className=\"gear-item-info\">\r\n                                                    <span className=\"build-item__label--compact\">{manifestService.getItem(g.item.hash)?.displayProperties?.name}</span>\r\n                                                    {renderCompactMods(g.group, g.cosmetics.ornament, g.cosmetics.shader)}\r\n                                                </div>\r\n                                            </>\r\n                                        ) : (\r\n                                            <div className=\"gear-placeholder\">\r\n                                                <div className=\"gear-placeholder__icon\" />\r\n                                                <span>{g.label} EMPTY</span>\r\n                                            </div>\r\n                                        )}\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"synergy-build-overlay__footer-bar\">\r\n                <div className=\"key-prompt\" onClick={() => setIsMenuVisible(!isMenuVisible)}>\r\n                    <div className=\"key-cap\">CTRL</div>\r\n                    <div className=\"key-label\">{isMenuVisible ? 'Hide' : 'Show'} Menu</div>\r\n                </div>\r\n                {activeLoadout?.source !== 'exoengine' && (\r\n                    <>\r\n                        <div className=\"key-prompt\" onClick={handleCopyExoEngineLink}>\r\n                            <div className=\"key-cap\">S</div>\r\n                            <div className=\"key-label\">Copy Exo Link</div>\r\n                        </div>\r\n                        <div className=\"key-prompt\" onClick={handleCopyDIMLink}>\r\n                            <div className=\"key-cap\">G</div>\r\n                            <div className=\"key-label\">Copy DIM Link</div>\r\n                        </div>\r\n                    </>\r\n                )}\r\n                <div className=\"key-prompt\" onClick={() => navigate('/agent-wake')}>\r\n                    <div className=\"key-cap\">ESC</div>\r\n                    <div className=\"key-label\">Back</div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Hover Tooltip Overlay */}\r\n            {hoveredItemHash !== null && (\r\n                <div className=\"fixed-tooltip-container\">\r\n                    <RichTooltip\r\n                        item={manifestService.getItem(hoveredItemHash)}\r\n                    />\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default LoadoutViewerPage;\r\n"],"names":["ELEMENT_NAMES","CLASS_NAMES","LoadoutViewerPage","encodedData","useParams","navigate","useNavigate","activeLoadout","setActiveLoadout","useState","isLoading","setIsLoading","error","setError","isManifestLoaded","setIsManifestLoaded","isMenuVisible","setIsMenuVisible","hoveredItemHash","setHoveredItemHash","mousePos","setMousePos","handleMouseMove","e","clientX","clientY","innerWidth","innerHeight","x","y","notification","setNotification","notificationTimeout","setNotificationTimeout","showNotification","message","timeout","useEffect","manifestService","err","errorLog","handleKeyDown","activeEl","p","handleCopyDIMLink","handleCopyExoEngineLink","link","loadoutLinkService","decoded","jsxs","jsx","LoadingScreen","gear","item","def","bucket","BUCKET_HASHES","buildIcons","getBungieUrl","subclassDef","damageType","elementName","indexToGroup","HASH_TO_GROUP","cat","group","idx","idxStr","hash","data","category","name","a","priority","b","typeName","f","modGroupsData","distributeLoadoutMods","modGroups","armorCosmetics","renderCompactMods","slotMods","ornament","shader","mainStat","secondaryStat","others","categorizeMods","renderCosmeticPod","renderModPod","h","helmetCosmetics","armsCosmetics","chestCosmetics","legsCosmetics","classItemCosmetics","ability","i","SubclassNode","aspect","fragment","w","Fragment","RichItemIcon","g","RichTooltip"],"mappings":"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"}